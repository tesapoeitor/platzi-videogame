var b=Object.defineProperty;var H=(l,e,s)=>e in l?b(l,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[e]=s;var i=(l,e,s)=>(H(l,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const X of n.addedNodes)X.tagName==="LINK"&&X.rel==="modulepreload"&&o(X)}).observe(document,{childList:!0,subtree:!0});function s(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(t){if(t.ep)return;t.ep=!0;const n=s(t);fetch(t.href,n)}})();const _={"-":" ",O:"\u{1F6AA}",X:"\u{1F4A3}",I:"\u{1F381}",PLAYER:"\u{1F480}",BOMB_COLLISION:"\u{1F525}",GAME_OVER:"\u{1F44E}",WIN:"\u{1F3C6}",HEART:"\u2764\uFE0F"},x=[];x.push(`
    IXXXXXXXXX
    -XXXXXXXXX
    -XXXXXXXXX
    -XXXXXXXXX
    -XXXXXXXXX
    -XXXXXXXXX
    -XXXXXXXXX
    -XXXXXXXXX
    -XXXXXXXXX
    OXXXXXXXXX
  `);x.push(`
    O--XXXXXXX
    X--XXXXXXX
    XX----XXXX
    X--XX-XXXX
    X-XXX--XXX
    X-XXXX-XXX
    XX--XX--XX
    XX--XXX-XX
    XXXX---IXX
    XXXXXXXXXX
    `);x.push(`
    I-----XXXX
    XXXXX-XXXX
    XX----XXXX
    XX-XXXXXXX
    XX-----XXX
    XXXXXX-XXX
    XX-----XXX
    XX-XXXXXXX
    XX-----OXX
    XXXXXXXXXX
  `);const c=class{constructor(e,s,o,t){i(this,"_level",0);i(this,"playerPosition",{x:void 0,y:void 0});i(this,"giftPosition",{x:void 0,y:void 0});i(this,"enemyPositions",[{x:void 0,y:void 0}]);i(this,"_elementsSize",0);i(this,"_mapRowCols",[[]]);this._time=e,this._record=s,this._lives=o,this._display=t}static create(e,s,o,t){return c.instance===null&&(console.log("Se crea una instancia de Game"),c.instance=new c(e,s,o,t)),c.instance}gameWin(){console.log("ganaste el juego"),this._time.end(),this._record.save()}render(e){this._display.game.clearRect(0,0,this._display.canvasSize,this._display.canvasSize),this.resetEnemyPositions(),e.forEach((s,o)=>{s.forEach((t,n)=>{const X=_[t],a=this.elementsSize*(o+1),r=this.elementsSize*(n+1);t==="O"&&!this.playerPosition.x&&!this.playerPosition.y?(this.playerPosition.x=a,this.playerPosition.y=r):t==="I"?(this.giftPosition.x=a,this.giftPosition.y=r):t==="X"&&this.enemyPositions.push({x:a,y:r}),this._display.game.fillText(X,a,r)})}),this.playerPosition.x&&this.playerPosition.y&&this._display.game.fillText(_.PLAYER,this.playerPosition.x,this.playerPosition.y)}startGame(){this.elementsSize=this._display.canvasSize/10,this._display.game.font=`${this.elementsSize}px Verdana`,this._display.game.textAlign="end";const e=x[this._level];if(!e){this.gameWin();return}this._time.start(),this._record.show();const s=e.trim().split(`
`);this.mapRowCols=s.map(o=>o.trim().split("")),this._lives.showLives(),this.render(this.mapRowCols)}get level(){return this._level}levelUp(){this._level++}resetLevel(){this._level=0}levelWin(){console.log("pasaste de nivel"),this.levelUp(),this.startGame()}levelFail(){console.log("chocaste contra un enemigo"),console.log("this "+this),this._lives.reduceLives(),this._lives.lives<=0&&(this.resetLevel(),this._lives.resetLives(),this._time.end()),this.resetPlayerPosition(),this.startGame()}resetPlayerPosition(){this.playerPosition.x=void 0,this.playerPosition.y=void 0}resetEnemyPositions(){this.enemyPositions=[]}set elementsSize(e){this._elementsSize=e}get elementsSize(){return this._elementsSize}set mapRowCols(e){this._mapRowCols=e}get mapRowCols(){return this._mapRowCols}get display(){return this._display}};let g=c;i(g,"instance",null);const h=class{constructor(e,s=e.display){this._game=e,this._display=s}static create(e){return h.instance===null&&(console.log("Se crea una instancia de Player"),h.instance=new h(e)),h.instance}movePlayer(e,s){var a,r,E,R;const o=((a=this._game.playerPosition.x)==null?void 0:a.toFixed(3))==((r=this._game.giftPosition.x)==null?void 0:r.toFixed(3)),t=((E=this._game.playerPosition.y)==null?void 0:E.toFixed(3))==((R=this._game.giftPosition.y)==null?void 0:R.toFixed(3));if(o&&t&&this._game.levelWin(),this._game.enemyPositions.find(T=>{var C,A,O,q;const D=((C=this._game.playerPosition.x)==null?void 0:C.toFixed(3))==((A=T.x)==null?void 0:A.toFixed(3)),Y=((O=this._game.playerPosition.y)==null?void 0:O.toFixed(3))==((q=T.y)==null?void 0:q.toFixed(3));return D&&Y})){this._display.game.fillText(_.BOMB_COLLISION,e,s),setTimeout(this._game.levelFail.bind(this._game),500);return}this._display.game.fillText(_.PLAYER,e,s)}move(e){return()=>{this._game.playerPosition.x&&this._game.playerPosition.y&&(e==="up"&&parseInt(this._game.playerPosition.y.toFixed(3))>parseInt(this._game.elementsSize.toFixed(3))?this._game.playerPosition.y-=this._game.elementsSize:e==="right"&&parseInt(this._game.playerPosition.x.toFixed(3))<parseInt(this._display.canvasSize.toFixed(3))?this._game.playerPosition.x+=this._game.elementsSize:e==="down"&&parseInt(this._game.playerPosition.y.toFixed(3))<parseInt(this._display.canvasSize.toFixed(3))?this._game.playerPosition.y+=this._game.elementsSize:e==="left"&&parseInt(this._game.playerPosition.x.toFixed(3))>parseInt(this._game.elementsSize.toFixed(3))&&(this._game.playerPosition.x-=this._game.elementsSize),this._game.render(this._game.mapRowCols),this.movePlayer(this._game.playerPosition.x,this._game.playerPosition.y))}}moveByKey(e){e.key=="ArrowUp"?this.move("up")():e.key=="ArrowLeft"?this.move("left")():e.key=="ArrowRight"?this.move("right")():e.key=="ArrowDown"&&this.move("down")()}};let v=h;i(v,"instance",null);const m=class{constructor(){i(this,"_canvas",document.querySelector("#game"));i(this,"_game",this._canvas.getContext("2d"));i(this,"_canvasSize",0);i(this,"displaySize",()=>{window.innerHeight>window.innerWidth?this._canvasSize=window.innerWidth*.8:this._canvasSize=window.innerHeight*.8,this._canvas.setAttribute("width",String(this._canvasSize)),this._canvas.setAttribute("height",String(this._canvasSize))})}static create(){return m.instance===null&&(console.log("Se crea una instancia de Display"),m.instance=new m),m.instance}get canvas(){return this._canvas}get game(){return this._game}set canvasSize(e){this._canvasSize=e}get canvasSize(){return this._canvasSize}};let f=m;i(f,"instance",null);var N;const d=class{constructor(){i(this,"_timeStart",0);i(this,"_timePlayer",parseInt((N=localStorage.getItem("record_time"))!=null?N:"0"));i(this,"_timeInterval");i(this,"_htmlNode",document.querySelector("#time"))}static create(){return d.instance===null&&(console.log("Se crea una instancia de Time"),d.instance=new d),d.instance}set timeStart(e){this._timeStart=e}get timeStart(){return this._timeStart}get playerTime(){return this._timePlayer}start(){this._timeInterval||(this._timeStart=Date.now(),this._timeInterval=setInterval(this.showTimeDisplay.bind(this),100))}end(){this._timePlayer=Date.now()-this._timeStart,console.log("tiempo "+this._timePlayer),this._timeStart=0,clearInterval(this._timeInterval),this._timeInterval=void 0}showTimeDisplay(){this._timePlayer=Date.now()-this._timeStart,this._htmlNode.innerText=`${this._timePlayer}`}};let S=d;i(S,"instance",null);const u=class{constructor(){i(this,"_lives",3);i(this,"_spanLives",document.querySelector("#lives"))}static create(){return u.instance===null&&(console.log("Se crea una instancia de Lives"),u.instance=new u),u.instance}get lives(){return this._lives}reduceLives(){this._lives--}resetLives(){this._lives=3}showLives(){const e=Array(this._lives).fill(_.HEART);this._spanLives.innerText="",e.forEach(s=>this._spanLives.innerText+=s)}};let P=u;i(P,"instance",null);const y=class{constructor(e){i(this,"_spanRecord",document.querySelector("#record"));i(this,"_pResult",document.querySelector("#result"));i(this,"_recordTime",localStorage.getItem("record_time"));this._time=e}static create(e){return y.instance===null&&(console.log("Se crea una instancia de Record"),y.instance=new y(e)),y.instance}save(){this._recordTime?parseInt(this._recordTime)>this._time.playerTime?(localStorage.setItem("record_time",String(this._time.playerTime)),this._pResult.innerText="SUPERASTE EL RECORD \u{1F609}"):this._pResult.innerText="Lo siento, no superaste el record \u{1F62A}":(localStorage.setItem("record_time",String(this._time.playerTime)),this._pResult.innerText="Primera vez? Muy bien, pero ahora trata de superar tu tiempo")}show(){const e=localStorage.getItem("record_time");this._spanRecord.innerHTML=`${e}`}};let w=y;i(w,"instance",null);const z=document.querySelector("#up"),I=document.querySelector("#left"),L=document.querySelector("#right"),F=document.querySelector("#down"),M=f.create(),W=S.create(),G=P.create(),j=w.create(W),k=g.create(W,j,G,M),p=v.create(k),B=()=>{M.displaySize(),k.startGame()};window.addEventListener("DOMContentLoaded",B);window.addEventListener("resize",B);window.addEventListener("keydown",p.moveByKey.bind(p));z==null||z.addEventListener("click",p.move("up"));I==null||I.addEventListener("click",p.move("left"));L==null||L.addEventListener("click",p.move("right"));F==null||F.addEventListener("click",p.move("down"));
