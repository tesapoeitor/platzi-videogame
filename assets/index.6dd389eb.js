var D=Object.defineProperty;var G=(l,e,s)=>e in l?D(l,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[e]=s;var i=(l,e,s)=>(G(l,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const X of n.addedNodes)X.tagName==="LINK"&&X.rel==="modulepreload"&&o(X)}).observe(document,{childList:!0,subtree:!0});function s(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(t){if(t.ep)return;t.ep=!0;const n=s(t);fetch(t.href,n)}})();const u={"-":" ",O:"\u{1F6AA}",X:"\u{1F4A3}",I:"\u{1F381}",PLAYER:"\u{1F480}",BOMB_COLLISION:"\u{1F525}",GAME_OVER:"\u{1F44E}",WIN:"\u{1F3C6}",HEART:"\u2764\uFE0F"},w=[];w.push(`
    IXXXXXXXXX
    -XXXXXXXXX
    -XXXXXXXXX
    -XXXXXXXXX
    -XXXXXXXXX
    -XXXXXXXXX
    -XXXXXXXXX
    -XXXXXXXXX
    -XXXXXXXXX
    OXXXXXXXXX
  `);w.push(`
    O--XXXXXXX
    X--XXXXXXX
    XX----XXXX
    X--XX-XXXX
    X-XXX--XXX
    X-XXXX-XXX
    XX--XX--XX
    XX--XXX-XX
    XXXX---IXX
    XXXXXXXXXX
    `);w.push(`
    I-----XXXX
    XXXXX-XXXX
    XX----XXXX
    XX-XXXXXXX
    XX-----XXX
    XXXXXX-XXX
    XX-----XXX
    XX-XXXXXXX
    XX-----OXX
    XXXXXXXXXX
  `);const h=class{constructor(e,s,o,t){i(this,"_level",0);i(this,"playerPosition",{x:void 0,y:void 0});i(this,"giftPosition",{x:void 0,y:void 0});i(this,"enemyPositions",[{x:void 0,y:void 0}]);i(this,"_elementsSize",0);i(this,"_mapRowCols",[[]]);i(this,"_isFinish",!1);this._time=e,this._record=s,this._lives=o,this._display=t}static create(e,s,o,t){return h.instance===null&&(h.instance=new h(e,s,o,t)),h.instance}gameWin(){this._time.end(),this._record.save(),this._isFinish=!0;const e=this.display.canvasSize/2;this._display.game.textAlign="center",this._display.game.fillStyle="white",this._display.game.fillText("Ganaste!",e,e),this._display.game.textAlign="end"}render(e){this._display.game.clearRect(0,0,this._display.canvasSize,this._display.canvasSize),this.resetEnemyPositions(),e.forEach((s,o)=>{s.forEach((t,n)=>{const X=u[t],a=this.elementsSize*(n+1),r=this.elementsSize*(o+1);t==="O"&&!this.playerPosition.x&&!this.playerPosition.y?(this.playerPosition.x=a,this.playerPosition.y=r):t==="I"?(this.giftPosition.x=a,this.giftPosition.y=r):t==="X"&&this.enemyPositions.push({x:a,y:r}),this._display.game.fillText(X,a,r)})}),this.playerPosition.x&&this.playerPosition.y&&this._display.game.fillText(u.PLAYER,this.playerPosition.x,this.playerPosition.y)}startGame(){this.elementsSize=this._display.canvasSize/10,this._display.game.font=`${this.elementsSize}px Verdana`,this._display.game.textAlign="end";const e=w[this._level];if(!e){this.isFinish||this.gameWin();return}this._time.start();const s=e.trim().split(`
`);this.mapRowCols=s.map(o=>o.trim().split("")),this._lives.showLives(),this._record.show(),this.render(this.mapRowCols)}get level(){return this._level}levelUp(){this._level++}resetLevel(){this._level=0}levelWin(){this.levelUp(),this.startGame()}levelFail(){this._lives.reduceLives(),this.resetPlayerPosition(),this._lives.lives<=0?(this.resetLevel(),this._lives.resetLives(),this._time.end(),this.gameOver(),setTimeout(this.startGame.bind(this),2e3)):this.startGame()}gameOver(){for(let e=0;e<10;e++)for(let s=0;s<10;s++){const o=u.BOMB_COLLISION,t=this.elementsSize*(s+1),n=this.elementsSize*(e+1);this._display.game.fillText(o,t,n)}}resetPlayerPosition(){this.playerPosition.x=void 0,this.playerPosition.y=void 0}resetEnemyPositions(){this.enemyPositions=[]}set elementsSize(e){this._elementsSize=e}get elementsSize(){return this._elementsSize}set mapRowCols(e){this._mapRowCols=e}get mapRowCols(){return this._mapRowCols}get display(){return this._display}get isFinish(){return this._isFinish}};let g=h;i(g,"instance",null);const c=class{constructor(e,s=e.display){this._game=e,this._display=s}static create(e){return c.instance===null&&(c.instance=new c(e)),c.instance}movePlayer(e,s){var a,r,T,E;const o=((a=this._game.playerPosition.x)==null?void 0:a.toFixed(3))==((r=this._game.giftPosition.x)==null?void 0:r.toFixed(3)),t=((T=this._game.playerPosition.y)==null?void 0:T.toFixed(3))==((E=this._game.giftPosition.y)==null?void 0:E.toFixed(3));if(o&&t&&this._game.levelWin(),this._game.enemyPositions.find(A=>{var O,C,R,q;const b=((O=this._game.playerPosition.x)==null?void 0:O.toFixed(3))==((C=A.x)==null?void 0:C.toFixed(3)),k=((R=this._game.playerPosition.y)==null?void 0:R.toFixed(3))==((q=A.y)==null?void 0:q.toFixed(3));return b&&k})){this._display.game.fillText(u.BOMB_COLLISION,e,s),setTimeout(this._game.levelFail.bind(this._game),500);return}this._display.game.fillText(u.PLAYER,e,s)}move(e){return()=>{this._game.playerPosition.x&&this._game.playerPosition.y&&(e==="up"&&parseInt(this._game.playerPosition.y.toFixed(3))>parseInt(this._game.elementsSize.toFixed(3))?this._game.playerPosition.y-=this._game.elementsSize:e==="right"&&parseInt(this._game.playerPosition.x.toFixed(3))<parseInt(this._display.canvasSize.toFixed(3))?this._game.playerPosition.x+=this._game.elementsSize:e==="down"&&parseInt(this._game.playerPosition.y.toFixed(3))<parseInt(this._display.canvasSize.toFixed(3))?this._game.playerPosition.y+=this._game.elementsSize:e==="left"&&parseInt(this._game.playerPosition.x.toFixed(3))>parseInt(this._game.elementsSize.toFixed(3))&&(this._game.playerPosition.x-=this._game.elementsSize),this._game.startGame(),this._game.isFinish||this.movePlayer(this._game.playerPosition.x,this._game.playerPosition.y))}}moveByKey(e){e.key=="ArrowUp"?this.move("up")():e.key=="ArrowLeft"?this.move("left")():e.key=="ArrowRight"?this.move("right")():e.key=="ArrowDown"&&this.move("down")()}};let v=c;i(v,"instance",null);const m=class{constructor(){i(this,"_canvas",document.querySelector("#game"));i(this,"_game",this._canvas.getContext("2d"));i(this,"_canvasSize",0);i(this,"displaySize",()=>{window.innerHeight>window.innerWidth?this._canvasSize=window.innerWidth*.8:this._canvasSize=window.innerHeight*.8,this._canvas.setAttribute("width",String(this._canvasSize)),this._canvas.setAttribute("height",String(this._canvasSize))})}static create(){return m.instance===null&&(console.log("Se crea una instancia de Display"),m.instance=new m),m.instance}get canvas(){return this._canvas}get game(){return this._game}set canvasSize(e){this._canvasSize=e}get canvasSize(){return this._canvasSize}};let f=m;i(f,"instance",null);var N;const d=class{constructor(){i(this,"_timeStart",0);i(this,"_timePlayer",parseInt((N=localStorage.getItem("record_time"))!=null?N:"0"));i(this,"_timeInterval");i(this,"_htmlNode",document.querySelector("#time"))}static create(){return d.instance===null&&(d.instance=new d),d.instance}set timeStart(e){this._timeStart=e}get timeStart(){return this._timeStart}get playerTime(){return this._timePlayer}start(){this._timeInterval||(this._timeStart=Date.now(),this._timeInterval=setInterval(this.showTimeDisplay.bind(this),100))}end(){this._timePlayer=Date.now()-this._timeStart,this._timeStart=0,clearInterval(this._timeInterval),this._timeInterval=void 0}showTimeDisplay(){this._timePlayer=Date.now()-this._timeStart,this._htmlNode.innerText=`${this._timePlayer}`}};let S=d;i(S,"instance",null);const y=class{constructor(){i(this,"_lives",3);i(this,"_spanLives",document.querySelector("#lives"))}static create(){return y.instance===null&&(y.instance=new y),y.instance}get lives(){return this._lives}reduceLives(){this._lives--}resetLives(){this._lives=3}showLives(){const e=Array(this._lives).fill(u.HEART);this._spanLives.innerText="",e.forEach(s=>this._spanLives.innerText+=s)}};let P=y;i(P,"instance",null);const p=class{constructor(e){i(this,"_spanRecord",document.querySelector("#record"));i(this,"_pResult",document.querySelector("#result"));i(this,"_recordTime",localStorage.getItem("record_time")||"");this._time=e}static create(e){return p.instance===null&&(p.instance=new p(e)),p.instance}save(){this._recordTime?parseInt(this._recordTime)>this._time.playerTime?(localStorage.setItem("record_time",String(this._time.playerTime)),this._pResult.innerText="SUPERASTE EL RECORD \u{1F609}"):this._pResult.innerText="Lo siento, no superaste el record \u{1F62A}":(localStorage.setItem("record_time",String(this._time.playerTime)),this._recordTime=String(this._time.playerTime),this._pResult.innerText="Primera vez? Muy bien, pero ahora trata de superar tu tiempo"),this.show()}show(){this._spanRecord.innerHTML=`${this._recordTime}`}};let x=p;i(x,"instance",null);const z=document.querySelector("#up"),F=document.querySelector("#left"),I=document.querySelector("#right"),L=document.querySelector("#down"),B=f.create(),M=S.create(),H=P.create(),j=x.create(M),W=g.create(M,j,H,B),_=v.create(W),Y=()=>{B.displaySize(),W.startGame()};window.addEventListener("DOMContentLoaded",Y);window.addEventListener("resize",Y);window.addEventListener("keydown",_.moveByKey.bind(_));z==null||z.addEventListener("click",_.move("up"));F==null||F.addEventListener("click",_.move("left"));I==null||I.addEventListener("click",_.move("right"));L==null||L.addEventListener("click",_.move("down"));
